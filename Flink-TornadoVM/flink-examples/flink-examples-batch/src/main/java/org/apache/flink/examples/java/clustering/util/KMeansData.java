/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.flink.examples.java.clustering.util;

import org.apache.flink.api.java.DataSet;
import org.apache.flink.api.java.ExecutionEnvironment;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.api.java.tuple.Tuple3;

import java.util.LinkedList;
import java.util.List;

/**
 * Provides the default data sets used for the K-Means example program.
 * The default data sets are used, if no parameters are given to the program.
 *
 */
public class KMeansData {

	// We have the data as object arrays so that we can also generate Scala Data Sources from it.
	public static final Object[][] CENTROIDS = new Object[][] {
		new Object[] {1, 0.17478379198971572, 0.07033600096744186},
		new Object[]{2, 0.937730156169436, 0.1517355696206395}
	};

	public static final Object[][] POINTS = new Object[][] {
		new Object[] {0.7905097719624303, 0.1607300722852828},
		new Object[] {0.2466323316591641, 0.64032475070355},
		new Object[] {0.4747272921411063, 0.608505263395753},
		new Object[] {0.21221603013111745, 0.20627390984944716},
		new Object[] {0.5026621267572294, 0.3747239309860291},
		new Object[] {0.8275359018543106, 0.5600333605029916},
		new Object[] {0.9521190830848423, 0.9461374435031441},
		new Object[] {0.12837436037232808, 0.8421359843711869},
		new Object[] {0.25997958485325645, 0.5825747508731993},
		new Object[] {0.9706987200411233, 0.6636732546846094},
		new Object[] {0.06374338788384448, 0.21333118125254813},
		new Object[] {0.5943104229631846, 0.41893276389666956},
		new Object[] {0.06822555125721097, 0.3718121001877873},
		new Object[] {0.1353706471227608, 0.35359093695290456},
		new Object[] {0.46673564671098366, 0.8259321960107451},
		new Object[] {0.32855542170221264, 0.9956693252474434},
		new Object[] {0.12673109625079826, 0.5314989277718598},
		new Object[] {0.9608825799261704, 0.7918138600231494},
		new Object[] {0.9618497649123509, 0.2867836901060252},
		new Object[] {0.9917917772760209, 0.3080588380993471},
		new Object[] {0.6553917357926283, 0.998712250076207},
		new Object[] {0.6378479448852478, 0.15208849051398887},
		new Object[] {0.1747335478390466, 0.7845814361187912},
		new Object[] {0.1354776810465982, 0.8531104446779714},
		new Object[] {0.3218229295680154, 0.22793649827833373},
		new Object[] {0.34143695471518887, 0.2958074415743519},
		new Object[] {0.9018157402866422, 0.9832194654918116},
		new Object[] {0.808247714625104, 0.9464346871678504},
		new Object[] {0.9600805222976684, 0.5810257776644768},
		new Object[] {0.4806299701043464, 0.03198212377005982},
		new Object[] {0.9372114270071692, 0.724282843444455},
		new Object[] {0.6989952756240804, 0.03742239133103231},
		new Object[] {0.5223523874438747, 0.5853910418348802},
		new Object[] {0.7673558800415182, 0.3714168469401772},
		new Object[] {0.44705155610598624, 0.6153435420633621},
		new Object[] {0.9455437756005217, 0.817453276183845},
		new Object[] {0.45502743186994166, 0.1580688883714293},
		new Object[] {0.3594222525869126, 0.43524108431881425},
		new Object[] {0.2076430363145758, 0.7267158891033024},
		new Object[] {0.9878121047125733, 0.9062906527129251},
		new Object[] {0.9405484366583375, 0.14332765815191062},
		new Object[] {0.5811431026494926, 0.9279556900713917},
		new Object[] {0.2738657138440017, 0.8693276714259027},
		new Object[] {0.09438126204706754, 0.1518184442264202},
		new Object[] {0.6964547361811013, 0.7614676269063854},
		new Object[] {0.9755706336981723, 0.335149699584693},
		new Object[] {0.894212344533956, 0.1763633035547636},
		new Object[] {0.44136792181215057, 0.8282766454522733},
		new Object[] {0.2730210541657717, 0.8164711276621345},
		new Object[] {0.6922372842573064, 0.2560435707149399},
		new Object[] {0.7388780383654768, 0.9613350136147838},
		new Object[] {0.8725113947679559, 0.2681516243428549},
		new Object[] {0.04089890863233847, 0.7601590722976987},
		new Object[] {0.46431430945407537, 0.5310156219930863},
		new Object[] {0.7573050014796238, 0.07523885201498115},
		new Object[] {0.7193804181912477, 0.7128775103577204},
		new Object[] {0.31016661387182143, 0.9605101504367277},
		new Object[] {0.6790931018083388, 0.07426735462821121},
		new Object[] {0.23158941784864284, 0.23545100575604894},
		new Object[] {0.310605570645318, 0.4175047230064697},
		new Object[] {0.27219426899023935, 0.7717987641202256},
		new Object[] {0.2956954144773317, 0.5717843770553047},
		new Object[] {0.8421560796750681, 0.04902142488761607},
		new Object[] {0.04904388641209434, 0.29449220479845417},
		new Object[] {0.7057298431449603, 0.25420807334545814},
		new Object[] {0.6139189966195814, 0.4547488498363267},
		new Object[] {0.812107601214713, 0.7030205196679297},
		new Object[] {0.1857820246512828, 0.631779345326081},
		new Object[] {0.638612858755906, 0.6405744865815899},
		new Object[] {0.1481246178259069, 0.8085600280997974},
		new Object[] {0.44665399646235093, 0.5445953016515787},
		new Object[] {0.6698838156348651, 0.6702938849569783},
		new Object[] {0.40652164125756773, 0.8979196360741886},
		new Object[] {0.11007084972084469, 0.12761869266793358},
		new Object[] {0.6340292691315245, 0.023391360557328378},
		new Object[] {0.7027887849909353, 0.07605226914951024},
		new Object[] {0.8001605696190834, 0.9814262242027302},
		new Object[] {0.25460299146429666, 0.07603227802458568},
		new Object[] {0.12430077301554054, 0.7189966552609109},
		new Object[] {0.8762679178894471, 0.5920083469861335},
		new Object[] {0.2422934675616869, 0.628514086177047},
		new Object[] {0.0921020378701658, 0.6643964510200859},
		new Object[] {0.6524783115360565, 0.42606377153516484},
		new Object[] {0.022842615903347685, 0.4048070414012769},
		new Object[] {0.18602954734903454, 0.7906723710491125},
		new Object[] {0.7216003376420976, 0.5028097025971062},
		new Object[] {0.22232841419134763, 0.5197663343097237},
		new Object[] {0.1575734288526337, 0.011598892148816708},
		new Object[] {0.1757678449140484, 0.05070456630571529},
		new Object[] {0.7884698031901886, 0.040277011907437044},
		new Object[] {0.11730057244614844, 0.07424645804064589},
		new Object[] {0.14012452181538726, 0.6220720021282805},
		new Object[] {0.26220686367158197, 0.6230421860620312},
		new Object[] {0.32058941638632765, 0.9506591376532066},
		new Object[] {0.4549716550861196, 0.456708945313929},
		new Object[] {0.9360104670639056, 0.38085744457704573},
		new Object[] {0.7128251050102283, 0.7847836469559671},
		new Object[] {0.4468976905563572, 0.07532321604284253},
		new Object[] {0.35141444366322483, 0.3698187521948483},
		new Object[] {0.6059312540547591, 0.9454644605819894},
		new Object[] {0.20923935927476967, 0.8351145317428988},
		new Object[] {0.2522368256161368, 0.5826516299772254},
		new Object[] {0.011896917837003862, 0.5650580786475771},
		new Object[] {0.4021019358675383, 0.2049017800893368},
		new Object[] {0.9728463979796838, 0.9307652655017745},
		new Object[] {0.2723944923211796, 0.2545647319987909},
		new Object[] {0.3143181641827988, 0.6996989394353562},
		new Object[] {0.6004832597065369, 0.17414109039236136},
		new Object[] {0.510154829306498, 0.395162873838784},
		new Object[] {0.38324973666778517, 0.06021422915683794},
		new Object[] {0.7017875159201805, 0.060047894200632945},
		new Object[] {0.9478193347816871, 0.3495791417378772},
		new Object[] {0.9192130034945675, 0.34893269153737416},
		new Object[] {0.08792912667985275, 0.4270031028944382},
		new Object[] {0.45075296849598345, 0.12361893369647003},
		new Object[] {0.8523887075347331, 0.06065462578988279},
		new Object[] {0.9485393949019387, 0.7594064451716493},
		new Object[] {0.45587922283736637, 0.8690884325259558},
		new Object[] {0.6310850835944252, 0.18289085069135746},
		new Object[] {0.6973750986926357, 0.6027760558209794},
		new Object[] {0.24996178693013116, 0.2567929879138705},
		new Object[] {0.2177620680754414, 0.8835233306866945},
		new Object[] {0.3245228362906527, 0.5033052936844027},
		new Object[] {0.9057639262450352, 0.18671691102979104},
		new Object[] {0.5167711426971174, 0.31466775987580464},
		new Object[] {0.7700795476419259, 0.2741945157858753},
		new Object[] {0.9178873571498692, 0.73816180960129},
		new Object[] {0.6356710848946011, 0.9896343856137182},
		new Object[] {0.448597016643552, 0.6424375427872809},
		new Object[] {0.09343289005935274, 0.31371126045788467},
		new Object[] {0.5374701804505775, 0.5730662002678559},
		new Object[] {0.23500997941722723, 0.8428679081377073},
		new Object[] {0.7344100248780834, 0.8874363066802219},
		new Object[] {0.8383239566913583, 0.40340242730751064},
		new Object[] {0.9410019726858336, 0.8225882231601894},
		new Object[] {0.8344032899314803, 0.3416736004650097},
		new Object[] {0.495058371007831, 0.9943089483495066},
		new Object[] {0.0824039727611745, 0.1415775917144283},
		new Object[] {0.43360803214608334, 0.45178504318448764},
		new Object[] {0.7072455186683255, 0.41205123667138766},
		new Object[] {0.8767439974139232, 0.8193385478955801},
		new Object[] {0.5130765186856662, 0.9602086724200068},
		new Object[] {0.624156883914762, 0.24524675655822314},
		new Object[] {0.2758228036911179, 0.6198194614268078},
		new Object[] {0.7368451873548266, 0.8473740697800346},
		new Object[] {0.03936062083703207, 0.7401880175076394},
		new Object[] {0.08840826853081063, 0.09631996886275696},
		new Object[] {0.8923959373981725, 0.7570959400247856},
		new Object[] {0.6134914039242001, 0.10901409744617419},
		new Object[] {0.0869203657148705, 0.06531968687462975},
		new Object[] {0.25536661768129165, 0.13916602401043576},
		new Object[] {0.774153127411968, 0.491338668930003},
		new Object[] {0.42029700498148703, 0.6457034310782431},
		new Object[] {0.08016736092846966, 0.025199543530710966},
		new Object[] {0.08324630772767472, 0.19630979914108238},
		new Object[] {0.7209386388529726, 0.11210426220759084},
		new Object[] {0.5576596573348837, 0.12039826421119693},
		new Object[] {0.8653420571900872, 0.7271411853938754},
		new Object[] {0.3414551197051039, 0.2643356100368536},
		new Object[] {0.4946635501283422, 0.6606800611028891},
		new Object[] {0.38203030536173443, 0.42145674641295505},
		new Object[] {0.0784804558847566, 0.9273030989505906},
		new Object[] {0.5650018464209291, 0.010386238927923674},
		new Object[] {0.9893047835852204, 0.977745919387981},
		new Object[] {0.22456010756405897, 0.35741065520159576},
		new Object[] {0.71217226857145, 0.44117407390166197},
		new Object[] {0.9977346466551665, 0.502121428112288},
		new Object[] {0.570398978435019, 0.4542219082467823},
		new Object[] {0.40053153152038745, 0.790274827957239},
		new Object[] {0.3850167475073285, 0.24357249112881485},
		new Object[] {0.09081600513278254, 0.6437922312417591},
		new Object[] {0.21293701712111957, 0.5204585756259466},
		new Object[] {0.9009791175891592, 0.8050502930579154},
		new Object[] {0.06768272293648958, 0.4183163368387416},
		new Object[] {0.372840965325694, 0.04108715591551615},
		new Object[] {0.3165658842950838, 0.15892541522750148},
		new Object[] {0.7079064387231856, 0.7630776541416194},
		new Object[] {0.2694786564530083, 0.36771950306562384},
		new Object[] {0.7580045608096034, 0.26740666079663145},
		new Object[] {0.32700369192555523, 0.9755544408407967},
		new Object[] {0.9245055937648797, 0.33689670397674676},
		new Object[] {0.9393394026418741, 0.942071368949905},
		new Object[] {0.6087248216609183, 0.7542220824539686},
		new Object[] {0.5425745422543578, 0.6148945733437411},
		new Object[] {0.16178544120678895, 0.874268724985568},
		new Object[] {0.5851355404616858, 0.3992552304249044},
		new Object[] {0.11912764669732323, 0.7781752496710717},
		new Object[] {0.7347691291792028, 0.554233356091302},
		new Object[] {0.8730145308075196, 0.6890174752546794},
		new Object[] {0.3652119144186403, 0.3546624013656947},
		new Object[] {0.8357996870792541, 0.26757510629359826},
		new Object[] {0.46173751880950775, 0.5618422350124661},
		new Object[] {0.5773855584457828, 0.1263455927485646},
		new Object[] {0.1560611948416155, 0.1315577251951875},
		new Object[] {0.3822155544275876, 0.40094763760981944},
		new Object[] {0.20362031524854463, 0.3545017477702791},
		new Object[] {0.16430692162303773, 0.500281947173632},
		new Object[] {0.8500391792642682, 0.1720532827489457},
		new Object[] {0.7032456256346625, 0.22029505625729007},
		new Object[] {0.698624421380422, 0.23946243362307162},
		new Object[] {0.7197282978550111, 0.25091688827569636},
		new Object[] {0.38702763677336627, 0.4188459236349583},
		new Object[] {0.39615070536988295, 0.7317209375309843},
		new Object[] {0.10874972737499022, 0.775998337332711},
		new Object[] {0.5659058904177927, 0.9190811807885927},
		new Object[] {0.27395138007637543, 0.8278755484509287},
		new Object[] {0.9444695725878609, 0.216077193030775},
		new Object[] {0.894072854732785, 0.7417088964062419},
		new Object[] {0.45601403272078744, 0.786125165034958},
		new Object[] {0.5960552553888081, 0.42205971694124644},
		new Object[] {0.921206141426925, 0.7222892819509069},
		new Object[] {0.5244944152429707, 0.9387256305313438},
		new Object[] {0.11500913104835297, 0.2764541494637034},
		new Object[] {0.773848099972805, 0.5462615467090973},
		new Object[] {0.47772179341937604, 0.9660159885335994},
		new Object[] {0.4078556817083999, 0.624979906779702},
		new Object[] {0.5681524357767243, 0.47047644746534634},
		new Object[] {0.5696189625466871, 0.23364633600485119},
		new Object[] {0.6847399764797646, 0.10629977010865543},
		new Object[] {0.6633314054822317, 0.6056879535695632},
		new Object[] {0.9485975239505072, 0.32562026591539817},
		new Object[] {0.09743276305681514, 0.8435840167672114},
		new Object[] {0.5418684860315405, 0.12286419050572883},
		new Object[] {0.6190045063068725, 0.27020938951099227},
		new Object[] {0.7254492589968266, 0.45307573112710775},
		new Object[] {0.840510873296012, 0.38125299809813784},
		new Object[] {0.7220463076715118, 0.7667145997233182},
		new Object[] {0.16252931734561693, 0.10943561148845304},
		new Object[] {0.543699968900377, 0.5479181181027257},
		new Object[] {0.9299033552756301, 0.15910191775215932},
		new Object[] {0.3673208912178798, 0.30669810525456176},
		new Object[] {0.32378940147039736, 0.4988641367408777},
		new Object[] {0.11744940745178556, 0.8202688593372325},
		new Object[] {0.18835898703602805, 0.7103257484401779},
		new Object[] {0.5023622810558719, 0.5446795100439638},
		new Object[] {0.7184561821117614, 0.7825153252502326},
		new Object[] {0.867814649674471, 0.025150302206146558},
		new Object[] {0.6932992242066756, 0.1145122028336758},
		new Object[] {0.882120352606347, 0.821989061309449},
		new Object[] {0.7313548890222282, 0.9428474654400375},
		new Object[] {0.24693616566743848, 0.9386905900256816},
		new Object[] {0.8628023983640016, 0.14561468290375057},
		new Object[] {0.34003133396223817, 0.9897984542358803},
		new Object[] {0.5685435928725635, 0.39182694006748886},
		new Object[] {0.9394863357279067, 0.37833483698254333},
		new Object[] {0.31850441225691495, 0.9024083209779179},
		new Object[] {0.9531798550676259, 0.5660813147540414},
		new Object[] {0.5570121941105728, 0.6683090157263892},
		new Object[] {0.3830866733429461, 0.11471900927453837},
		new Object[] {0.029322374509143323, 0.8315851420822706},
		new Object[] {0.5908229195511424, 0.5518144340478716},
		new Object[] {0.32090704314440666, 0.07688633792298083},
		new Object[] {0.2990400114634454, 0.2728624963947721},
		new Object[] {0.4899069644817421, 0.3036445596758066},
		new Object[] {0.6626817659170211, 0.629075941751048},
		new Object[] {0.7131877816084942, 0.5533606974936304}
	};

	public static DataSet<Tuple3<Integer, Double, Double>> getDefaultCentroidDataSet(ExecutionEnvironment env) {
		List<Tuple3<Integer, Double, Double>> centroidList = new LinkedList<Tuple3<Integer, Double, Double>>();
		for (Object[] centroid : CENTROIDS) {
			centroidList.add(
				new Tuple3<>((Integer) centroid[0], (Double) centroid[1], (Double) centroid[2]));
		}
		return env.fromCollection(centroidList);
	}

	public static DataSet<Tuple2<Double, Double>> getDefaultPointDataSet(ExecutionEnvironment env) {
		List<Tuple2<Double, Double>> pointList = new LinkedList<Tuple2<Double, Double>>();
		for (Object[] point : POINTS) {
			pointList.add(new Tuple2<>((Double) point[0], (Double) point[1]));
		}
		return env.fromCollection(pointList);
	}

}
